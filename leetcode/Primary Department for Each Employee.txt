select e.employee_id, department_id
from employee e
where e.primary_flag='Y' or
(select count(*)
   from employee e1
  where e1.employee_id=e.employee_id)=1